{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "file-tree",
  "type": "registry:ui",
  "title": "File Tree",
  "description": "A component used to showcase the folder and file structure of a directory.",
  "files": [
    {
      "path": "registry/magicui/file-tree.tsx",
      "content": "\"use client\";\n\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\";\nimport { FileIcon, FolderIcon, FolderOpenIcon } from \"lucide-react\";\nimport React, {\n  createContext,\n  forwardRef,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { cn } from \"@/lib/utils\";\n\ntype TreeViewElement = {\n  id: string;\n  name: string;\n  isSelectable?: boolean;\n  children?: TreeViewElement[];\n};\n\ntype TreeContextProps = {\n  selectedId: string | undefined;\n  expandedItems: string[] | undefined;\n  indicator: boolean;\n  handleExpand: (id: string) => void;\n  selectItem: (id: string) => void;\n  setExpandedItems?: React.Dispatch<React.SetStateAction<string[] | undefined>>;\n  openIcon?: React.ReactNode;\n  closeIcon?: React.ReactNode;\n  direction: \"rtl\" | \"ltr\";\n};\n\nconst TreeContext = createContext<TreeContextProps | null>(null);\n\nconst useTree = () => {\n  const context = useContext(TreeContext);\n  if (!context) {\n    throw new Error(\"useTree must be used within a TreeProvider\");\n  }\n  return context;\n};\n\ninterface TreeViewComponentProps extends React.HTMLAttributes<HTMLDivElement> {}\n\ntype Direction = \"rtl\" | \"ltr\" | undefined;\n\ntype TreeViewProps = {\n  initialSelectedId?: string;\n  indicator?: boolean;\n  elements?: TreeViewElement[];\n  initialExpandedItems?: string[];\n  openIcon?: React.ReactNode;\n  closeIcon?: React.ReactNode;\n} & TreeViewComponentProps;\n\nconst Tree = forwardRef<HTMLDivElement, TreeViewProps>(\n  (\n    {\n      className,\n      elements,\n      initialSelectedId,\n      initialExpandedItems,\n      children,\n      indicator = true,\n      openIcon,\n      closeIcon,\n      dir,\n      ...props\n    },\n    ref,\n  ) => {\n    const [selectedId, setSelectedId] = useState<string | undefined>(\n      initialSelectedId,\n    );\n    const [expandedItems, setExpandedItems] = useState<string[] | undefined>(\n      initialExpandedItems,\n    );\n\n    const selectItem = useCallback((id: string) => {\n      setSelectedId(id);\n    }, []);\n\n    const handleExpand = useCallback((id: string) => {\n      setExpandedItems((prev) => {\n        if (prev?.includes(id)) {\n          return prev.filter((item) => item !== id);\n        }\n        return [...(prev ?? []), id];\n      });\n    }, []);\n\n    const expandSpecificTargetedElements = useCallback(\n      (elements?: TreeViewElement[], selectId?: string) => {\n        if (!elements || !selectId) return;\n        const findParent = (\n          currentElement: TreeViewElement,\n          currentPath: string[] = [],\n        ) => {\n          const isSelectable = currentElement.isSelectable ?? true;\n          const newPath = [...currentPath, currentElement.id];\n          if (currentElement.id === selectId) {\n            if (isSelectable) {\n              setExpandedItems((prev) => [...(prev ?? []), ...newPath]);\n            } else {\n              if (newPath.includes(currentElement.id)) {\n                newPath.pop();\n                setExpandedItems((prev) => [...(prev ?? []), ...newPath]);\n              }\n            }\n            return;\n          }\n          if (\n            isSelectable &&\n            currentElement.children &&\n            currentElement.children.length > 0\n          ) {\n            currentElement.children.forEach((child) => {\n              findParent(child, newPath);\n            });\n          }\n        };\n        elements.forEach((element) => {\n          findParent(element);\n        });\n      },\n      [],\n    );\n\n    useEffect(() => {\n      if (initialSelectedId) {\n        expandSpecificTargetedElements(elements, initialSelectedId);\n      }\n    }, [initialSelectedId, elements]);\n\n    const direction = dir === \"rtl\" ? \"rtl\" : \"ltr\";\n\n    return (\n      <TreeContext.Provider\n        value={{\n          selectedId,\n          expandedItems,\n          handleExpand,\n          selectItem,\n          setExpandedItems,\n          indicator,\n          openIcon,\n          closeIcon,\n          direction,\n        }}\n      >\n        <div className={cn(\"size-full\", className)}>\n          <ScrollArea\n            ref={ref}\n            className=\"relative h-full px-2\"\n            dir={dir as Direction}\n          >\n            <AccordionPrimitive.Root\n              {...props}\n              type=\"multiple\"\n              defaultValue={expandedItems}\n              value={expandedItems}\n              className=\"flex flex-col gap-1\"\n              onValueChange={(value) =>\n                setExpandedItems((prev) => [...(prev ?? []), value[0]])\n              }\n              dir={dir as Direction}\n            >\n              {children}\n            </AccordionPrimitive.Root>\n          </ScrollArea>\n        </div>\n      </TreeContext.Provider>\n    );\n  },\n);\n\nTree.displayName = \"Tree\";\n\nconst TreeIndicator = forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { direction } = useTree();\n\n  return (\n    <div\n      dir={direction}\n      ref={ref}\n      className={cn(\n        \"absolute left-1.5 h-full w-px rounded-md bg-muted py-3 duration-300 ease-in-out hover:bg-slate-300 rtl:right-1.5\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\n\nTreeIndicator.displayName = \"TreeIndicator\";\n\ninterface FolderComponentProps\n  extends React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item> {}\n\ntype FolderProps = {\n  expandedItems?: string[];\n  element: string;\n  isSelectable?: boolean;\n  isSelect?: boolean;\n} & FolderComponentProps;\n\nconst Folder = forwardRef<\n  HTMLDivElement,\n  FolderProps & React.HTMLAttributes<HTMLDivElement>\n>(\n  (\n    {\n      className,\n      element,\n      value,\n      isSelectable = true,\n      isSelect,\n      children,\n      ...props\n    },\n    ref,\n  ) => {\n    const {\n      direction,\n      handleExpand,\n      expandedItems,\n      indicator,\n      setExpandedItems,\n      openIcon,\n      closeIcon,\n    } = useTree();\n\n    return (\n      <AccordionPrimitive.Item\n        {...props}\n        value={value}\n        className=\"relative h-full overflow-hidden\"\n      >\n        <AccordionPrimitive.Trigger\n          className={cn(\n            `flex items-center gap-1 rounded-md text-sm`,\n            className,\n            {\n              \"bg-muted rounded-md\": isSelect && isSelectable,\n              \"cursor-pointer\": isSelectable,\n              \"cursor-not-allowed opacity-50\": !isSelectable,\n            },\n          )}\n          disabled={!isSelectable}\n          onClick={() => handleExpand(value)}\n        >\n          {expandedItems?.includes(value)\n            ? (openIcon ?? <FolderOpenIcon className=\"size-4\" />)\n            : (closeIcon ?? <FolderIcon className=\"size-4\" />)}\n          <span>{element}</span>\n        </AccordionPrimitive.Trigger>\n        <AccordionPrimitive.Content className=\"relative h-full overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\">\n          {element && indicator && <TreeIndicator aria-hidden=\"true\" />}\n          <AccordionPrimitive.Root\n            dir={direction}\n            type=\"multiple\"\n            className=\"ml-5 flex flex-col gap-1 py-1 rtl:mr-5 \"\n            defaultValue={expandedItems}\n            value={expandedItems}\n            onValueChange={(value) => {\n              setExpandedItems?.((prev) => [...(prev ?? []), value[0]]);\n            }}\n          >\n            {children}\n          </AccordionPrimitive.Root>\n        </AccordionPrimitive.Content>\n      </AccordionPrimitive.Item>\n    );\n  },\n);\n\nFolder.displayName = \"Folder\";\n\nconst File = forwardRef<\n  HTMLButtonElement,\n  {\n    value: string;\n    handleSelect?: (id: string) => void;\n    isSelectable?: boolean;\n    isSelect?: boolean;\n    fileIcon?: React.ReactNode;\n  } & React.ButtonHTMLAttributes<HTMLButtonElement>\n>(\n  (\n    {\n      value,\n      className,\n      handleSelect,\n      isSelectable = true,\n      isSelect,\n      fileIcon,\n      children,\n      ...props\n    },\n    ref,\n  ) => {\n    const { direction, selectedId, selectItem } = useTree();\n    const isSelected = isSelect ?? selectedId === value;\n    return (\n      <button\n        ref={ref}\n        type=\"button\"\n        disabled={!isSelectable}\n        className={cn(\n          \"flex w-fit items-center gap-1 rounded-md pr-1 text-sm duration-200 ease-in-out rtl:pl-1 rtl:pr-0\",\n          {\n            \"bg-muted\": isSelected && isSelectable,\n          },\n          isSelectable ? \"cursor-pointer\" : \"cursor-not-allowed opacity-50\",\n          direction === \"rtl\" ? \"rtl\" : \"ltr\",\n          className,\n        )}\n        onClick={() => selectItem(value)}\n        {...props}\n      >\n        {fileIcon ?? <FileIcon className=\"size-4\" />}\n        {children}\n      </button>\n    );\n  },\n);\n\nFile.displayName = \"File\";\n\nconst CollapseButton = forwardRef<\n  HTMLButtonElement,\n  {\n    elements: TreeViewElement[];\n    expandAll?: boolean;\n  } & React.HTMLAttributes<HTMLButtonElement>\n>(({ className, elements, expandAll = false, children, ...props }, ref) => {\n  const { expandedItems, setExpandedItems } = useTree();\n\n  const expendAllTree = useCallback((elements: TreeViewElement[]) => {\n    const expandTree = (element: TreeViewElement) => {\n      const isSelectable = element.isSelectable ?? true;\n      if (isSelectable && element.children && element.children.length > 0) {\n        setExpandedItems?.((prev) => [...(prev ?? []), element.id]);\n        element.children.forEach(expandTree);\n      }\n    };\n\n    elements.forEach(expandTree);\n  }, []);\n\n  const closeAll = useCallback(() => {\n    setExpandedItems?.([]);\n  }, []);\n\n  useEffect(() => {\n    console.log(expandAll);\n    if (expandAll) {\n      expendAllTree(elements);\n    }\n  }, [expandAll]);\n\n  return (\n    <Button\n      variant={\"ghost\"}\n      className=\"absolute bottom-1 right-2 h-8 w-fit p-1\"\n      onClick={\n        expandedItems && expandedItems.length > 0\n          ? closeAll\n          : () => expendAllTree(elements)\n      }\n      ref={ref}\n      {...props}\n    >\n      {children}\n      <span className=\"sr-only\">Toggle</span>\n    </Button>\n  );\n});\n\nCollapseButton.displayName = \"CollapseButton\";\n\nexport { CollapseButton, File, Folder, Tree, type TreeViewElement };\n",
      "type": "registry:ui",
      "target": "components/magicui/file-tree.tsx"
    }
  ]
}